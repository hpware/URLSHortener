---
let username = "";
---
<div>
    <h1 id="">Hello {username || "user"}</h1>
    <h2 id="">Nice to see you.</h2>
    <form id="submit">
        <label for="name">What is your name?</label>
        <input type="text" placeholder="Ex: Howard" required/>
        <button>Submit</button>
        <p id="error" class="error"></p>
    </form>
</div>

<script>
    document.getElementById("submit").addEventListener("submit", (e) => {
      e.preventDefault();
      const Input = document.getElementById("email") as HTMLInputElement;
      send(Input.value);
    });
    async function send(input: string) {
      try {
          const req = await fetch("/api/register", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
              type: "name",
              content: input,
            })
          })
          const res = await req.json();
          if (res.success !== true) {
            document.getElementById("error").innerText = "Server side error.";
          } else {
            window.location.href="/manage/setup-flow/2-username";
          }
      } catch (e) {
          document.getElementById("error").innerText = "Client side or Server side error.";
      }
    }
</script>

<style>
    .error {
        padding: 0;
        gap:0;
        margin: 0;
        color: rgb(141, 0, 0);
    }
</style>